<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="fproject.app.mybatis.mapper.CommentsMapper">
<!-- order="BEFORE" ==> insert수행전에 selectkey가 실행됨 
       		<selectKey resultType="int" keyProperty="commnum" order="BEFORE">       		
       			select SEQ_commnum.nextval from dual
       		</selectKey>
       		
--><!-- <![CDATA[>]]> -->
	
	<select id="list" resultType="fproject.app.fproject.vo.CommentsVo">
		select * from comments
	</select>

	<insert id="insert" parameterType="fproject.app.fproject.vo.CommentsVo">
			insert into comments
			values(SEQ_commnum.nextval,#{storynum},#{num},#{commcontent},#{commstep},#{commref},#{commlev})
	</insert>
		
	<update id="update" parameterType="fproject.app.fproject.vo.CommentsVo">
		update comments set commcontent=#{commcontent} where commnum=#{commnum}
	</update>
	
	<update id="insertReply" parameterType="fproject.app.fproject.vo.CommentsVo">
		update comments set commstep=commstep+1 
		where commref=#{commref} and commstep=#{commstep}	
	</update>
	<update id="update" parameterType="fproject.app.fproject.vo.CommentsVo">
		update comments set commcontent=#{commcontent}
		where commnum#{commnum}	
	</update>
	
	<delete id="delete" parameterType="int">
		delete from comments where commnum=#{commnum}
	</delete>
	
</mapper>